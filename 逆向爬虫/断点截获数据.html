<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrome断点调试练习 - 爬虫模拟</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        header {
            background-color: #4285f4;
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }
        h1 {
            margin: 0;
        }
        .exercise {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        h2 {
            color: #4285f4;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .instructions {
            background-color: #f9f9f9;
            padding: 15px;
            border-left: 4px solid #4285f4;
            margin: 15px 0;
        }
        button {
            background-color: #4285f4;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #3367d6;
        }
        .result-area {
            border: 1px solid #ddd;
            padding: 15px;
            margin: 15px 0;
            min-height: 50px;
            border-radius: 4px;
            background-color: #fafafa;
        }
        .product-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .product {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 4px;
            background-color: white;
        }
        .hidden {
            display: none;
        }
        .success {
            color: #0f9d58;
            font-weight: bold;
        }
        .hint {
            background-color: #fff8e1;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
        .code-snippet {
            background-color: #263238;
            color: #e0e0e0;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <header>
        <h1>Chrome断点调试练习 - 爬虫模拟</h1>
        <p>通过实际练习掌握Chrome开发者工具中的断点功能</p>
    </header>

    <div class="exercise">
        <h2>练习1: 基础断点使用</h2>
        <div class="instructions">
            <p><strong>目标:</strong> 学习如何设置和移除JavaScript断点</p>
            <p><strong>任务:</strong> 在下面的代码中找到<code>extractData</code>函数并设置断点，然后点击"开始提取"按钮</p>
            <p><strong>Chrome操作:</strong> 打开开发者工具 → Sources → 找到此页面 → 在行号上点击设置断点</p>
        </div>
        
        <button id="startExtract">开始提取</button>
        <div class="result-area" id="exercise1Result"></div>
        
        <div class="hint">
            <p><strong>提示:</strong> 断点可以让代码在执行到特定行时暂停，方便你检查变量状态和调用堆栈。</p>
        </div>
    </div>

    <div class="exercise">
        <h2>练习2: DOM变化断点</h2>
        <div class="instructions">
            <p><strong>目标:</strong> 学习如何设置DOM断点来监测元素变化</p>
            <p><strong>任务:</strong> 对下面的结果区域设置DOM子树修改断点，然后点击"加载产品"按钮</p>
            <p><strong>Chrome操作:</strong> Elements → 右键点击元素 → Break on → Subtree modifications</p>
        </div>
        
        <button id="loadProducts">加载产品</button>
        <div class="result-area" id="exercise2Result">
            <div class="product-list" id="productList"></div>
        </div>
        
        <div class="hint">
            <p><strong>提示:</strong> DOM断点对于追踪动态内容加载非常有用，特别是在单页面应用中。</p>
        </div>
    </div>

    <div class="exercise">
        <h2>练习3: 网络请求断点</h2>
        <div class="instructions">
            <p><strong>目标:</strong> 学习如何设置XHR/Fetch断点来监测API请求</p>
            <p><strong>任务:</strong> 设置一个当URL包含"api"时的XHR断点，然后点击"获取用户数据"按钮</p>
            <p><strong>Chrome操作:</strong> Sources → XHR Breakpoints → 点击"+"" → 输入"api"</p>
        </div>
        
        <button id="fetchUserData">获取用户数据</button>
        <div class="result-area" id="exercise3Result"></div>
        
        <div class="hint">
            <p><strong>提示:</strong> XHR断点可以帮助你分析网页与服务器之间的数据交换，对于理解API调用非常有用。</p>
        </div>
    </div>

    <div class="exercise">
        <h2>练习4: 事件监听器断点</h2>
        <div class="instructions">
            <p><strong>目标:</strong> 学习如何使用事件监听器断点</p>
            <p><strong>任务:</strong> 设置鼠标点击事件的事件监听器断点，然后点击"点击我"按钮</p>
            <p><strong>Chrome操作:</strong> Sources → Event Listener Breakpoints → Mouse → 勾选"click"</p>
        </div>
        
        <button id="clickMeButton">点击我</button>
        <div class="result-area" id="exercise4Result"></div>
        
        <div class="hint">
            <p><strong>提示:</strong> 事件监听器断点可以帮助你找到页面中处理特定事件的代码，无需事先知道代码位置。</p>
        </div>
    </div>

    <div class="exercise">
        <h2>练习5: 综合场景 - 模拟爬虫</h2>
        <div class="instructions">
            <p><strong>目标:</strong> 综合应用所有断点技巧分析一个复杂页面</p>
            <p><strong>任务:</strong> 使用各种断点技术分析下面的"电商网站"，找出价格数据是如何加载和渲染的</p>
        </div>
        
        <div id="mockEcommerceSite">
            <h3>模拟电商网站</h3>
            <button id="loadProductCatalog">加载产品目录</button>
            <button id="applyDiscount">应用折扣</button>
            <button id="sortProducts">按价格排序</button>
            
            <div class="product-catalog" id="productCatalog">
                <p>产品将在这里显示...</p>
            </div>
            
            <div class="shopping-cart">
                <h4>购物车</h4>
                <ul id="cartItems"></ul>
                <p>总价: $<span id="totalPrice">0.00</span></p>
            </div>
        </div>
        
        <div class="hint">
            <p><strong>提示:</strong> 尝试使用多种断点组合来全面了解数据流 - JavaScript断点、DOM断点、XHR断点和事件监听器断点。</p>
        </div>
    </div>

    <script>
        // 练习1: 基础断点
        document.getElementById('startExtract').addEventListener('click', function() {
            const resultArea = document.getElementById('exercise1Result');
            resultArea.innerHTML = '<p>开始提取数据...</p>';
            
            // 模拟数据提取函数 - 在这里设置断点
            setTimeout(() => {
                const data = extractData();
                resultArea.innerHTML = `<p class="success">数据提取完成: ${JSON.stringify(data)}</p>`;
            }, 1000);
        });

        function extractData() {
            // 这个函数是练习1的目标 - 在这里设置断点
            const products = [
                {id: 1, name: '产品A', price: 19.99},
                {id: 2, name: '产品B', price: 29.99},
                {id: 3, name: '产品C', price: 39.99}
            ];
            
            // 模拟一些数据处理
            const processedData = products.map(p => {
                return {
                    id: p.id,
                    name: p.name.toUpperCase(),
                    price: p.price * 0.9 // 应用10%折扣
                };
            });
            
            return processedData;
        }

        // 练习2: DOM变化断点
        document.getElementById('loadProducts').addEventListener('click', function() {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';
            
            // 模拟从服务器获取产品数据
            setTimeout(() => {
                const products = [
                    {name: '笔记本电脑', price: 1299.99, category: '电子'},
                    {name: '智能手机', price: 699.99, category: '电子'},
                    {name: '书籍', price: 24.99, category: '文化'},
                    {name: '耳机', price: 199.99, category: '电子'}
                ];
                
                products.forEach(product => {
                    const productElement = document.createElement('div');
                    productElement.className = 'product';
                    productElement.innerHTML = `
                        <h4>${product.name}</h4>
                        <p>价格: $${product.price.toFixed(2)}</p>
                        <p>类别: ${product.category}</p>
                    `;
                    productList.appendChild(productElement);
                });
            }, 1500);
        });

        // 练习3: 网络请求断点
        document.getElementById('fetchUserData').addEventListener('click', function() {
            const resultArea = document.getElementById('exercise3Result');
            resultArea.innerHTML = '<p>请求用户数据中...</p>';
            
            // 模拟API请求
            fetchUserData()
                .then(userData => {
                    resultArea.innerHTML = `
                        <p class="success">用户数据加载完成</p>
                        <pre>${JSON.stringify(userData, null, 2)}</pre>
                    `;
                })
                .catch(error => {
                    resultArea.innerHTML = `<p class="error">错误: ${error.message}</p>`;
                });
        });

        function fetchUserData() {
            return new Promise((resolve) => {
                // 模拟网络延迟
                setTimeout(() => {
                    resolve({
                        id: 12345,
                        name: '张三',
                        email: 'zhangsan@example.com',
                        membership: '黄金会员',
                        lastLogin: '2023-04-15'
                    });
                }, 2000);
            });
        }

        // 练习4: 事件监听器断点
        document.getElementById('clickMeButton').addEventListener('click', function() {
            const resultArea = document.getElementById('exercise4Result');
            resultArea.innerHTML = '<p>按钮被点击了!</p>';
            
            // 模拟一些处理
            setTimeout(() => {
                resultArea.innerHTML += '<p>处理点击事件完成</p>';
                
                // 触发一些DOM变化
                const newElement = document.createElement('div');
                newElement.textContent = '动态添加的内容 ' + new Date().toLocaleTimeString();
                resultArea.appendChild(newElement);
            }, 1000);
        });

        // 练习5: 综合场景
        document.getElementById('loadProductCatalog').addEventListener('click', function() {
            const catalog = document.getElementById('productCatalog');
            catalog.innerHTML = '<p>加载中...</p>';
            
            // 模拟API调用获取产品数据
            setTimeout(() => {
                const products = [
                    {id: 101, name: '4K电视', price: 899.99, stock: 15},
                    {id: 102, name: '游戏主机', price: 499.99, stock: 8},
                    {id: 103, name: '蓝牙音箱', price: 129.99, stock: 20},
                    {id: 104, name: '智能手表', price: 249.99, stock: 12}
                ];
                
                renderProducts(products);
            }, 2000);
        });

        document.getElementById('applyDiscount').addEventListener('click', function() {
            // 应用10%折扣
            const productElements = document.querySelectorAll('.product-item');
            productElements.forEach(element => {
                const priceElement = element.querySelector('.price');
                const originalPrice = parseFloat(priceElement.dataset.originalPrice);
                const discountedPrice = originalPrice * 0.9;
                priceElement.textContent = `$${discountedPrice.toFixed(2)}`;
            });
            
            document.querySelector('.product-catalog').innerHTML += 
                '<p class="success">已应用10%折扣!</p>';
        });

        document.getElementById('sortProducts').addEventListener('click', function() {
            const productContainer = document.getElementById('productCatalog');
            const products = Array.from(productContainer.querySelectorAll('.product-item'));
            
            products.sort((a, b) => {
                const priceA = parseFloat(a.querySelector('.price').dataset.originalPrice);
                const priceB = parseFloat(b.querySelector('.price').dataset.originalPrice);
                return priceA - priceB;
            });
            
            // 清空并重新添加排序后的产品
            productContainer.innerHTML = '';
            products.forEach(product => productContainer.appendChild(product));
            
            productContainer.innerHTML += '<p class="success">产品已按价格排序!</p>';
        });

        function renderProducts(products) {
            const catalog = document.getElementById('productCatalog');
            catalog.innerHTML = '<h4>产品目录</h4>';
            
            products.forEach(product => {
                const productElement = document.createElement('div');
                productElement.className = 'product-item';
                productElement.innerHTML = `
                    <div>
                        <h5>${product.name}</h5>
                        <p class="price" data-original-price="${product.price}">$${product.price.toFixed(2)}</p>
                        <p>库存: ${product.stock}件</p>
                        <button class="add-to-cart" data-id="${product.id}" data-price="${product.price}">加入购物车</button>
                    </div>
                `;
                catalog.appendChild(productElement);
            });
            
            // 添加购物车事件监听
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', function() {
                    const productId = this.dataset.id;
                    const productPrice = parseFloat(this.dataset.price);
                    addToCart(productId, productPrice);
                });
            });
        }

        function addToCart(productId, price) {
            const cartItems = document.getElementById('cartItems');
            const totalPriceElement = document.getElementById('totalPrice');
            
            const newItem = document.createElement('li');
            newItem.textContent = `产品 ${productId} - $${price.toFixed(2)}`;
            cartItems.appendChild(newItem);
            
            // 更新总价
            const currentTotal = parseFloat(totalPriceElement.textContent);
            totalPriceElement.textContent = (currentTotal + price).toFixed(2);
        }
    </script>
</body>
</html>